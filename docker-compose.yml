version: "3.8"
services:
  api_service:
    image: "fiap56soat1/fasteats-api:latest"
    restart: always
    ports:
      - "8080:8080"
    networks:
      - fiap-net-cozinha
    environment:
      - spring.data.mongodb.authentication-database:'admin'
      - spring.data.mongodb.username='sa'
      - spring.data.mongodb.password='teste@123'
      - spring.data.mongodb.database='fasteatsdb_cozinha'
      - spring.data.mongodb.port=27017
      - spring.data.mongodb.host='localhost'
    volumes:
      - .m2:/root/.m2
    depends_on:
      mongoDb:
        condition: service_healthy

  mongoDb:
    image: "mongo"
    restart: always
    ports:
      - "27017:27017"
    expose:
      - "27017"
    networks:
      - fiap-net-cozinha
    environment:
      MONGO_INITDB_ROOT_USERNAME: 'sa'
      MONGO_INITDB_ROOT_PASSWORD: 'teste@123'
networks:
  fiap-net-cozinha:
